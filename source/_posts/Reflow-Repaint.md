---
title: Reflow(回流)和Repaint(重绘)
date: 2017-11-02 15:35:46
tags:
---

浏览器在加载完所有组件会解析成一个DOM树，把所有的样式解析成样式结构体，DOM树和样式结构体构造渲染树(render tree),即生成两个内部数据结构---DOM树和渲染树。当两者构建成功后，浏览器开始显示页面元素。

重排：当DOM的变化影响了元素的几何属性，浏览器需要重新计算元素的几何属性，同样其他元素的几何属性和位置也受到了影响。浏览器会使渲染树中受到影响的部分失效，并重新该构造渲染树。这个过程叫重排。

重绘：当渲染树中的一些元素更新了属性，而这些属性只是影响了元素的外观，不影响布局。这个过程叫重绘。

PS：重排一定会引起重绘，重绘不一定会引起重排。

引起重排的情况：
- 添加或者删除可见的DOM元素
- 元素位置的改变
- 元素尺寸的改变
- 元素内容的改变
- 页面渲染初始化
- 浏览器窗口尺寸的改变

优化：
- 将多次改变样式的属性的操作合并成一次操作
- 需要多次重排的元素，position属性设置为absolute或fixed（脱离文档流，位置改变不影响其他元素）
- 在内存中完成多次操作，再添加到文档中
