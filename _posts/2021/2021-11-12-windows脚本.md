---
layout: post
tags: 2021 windows
title: Windows脚本
---

Windows 下的一些脚本记录。

## 注册表

关于注册表脚本 reg 的编写。

### 格式与语法

.Reg 脚本具有以下语法

```plain
RegistryEditorVersion
Black line
[RegistryPath1]

"DataItemName1"="DataType1:DataValue1"
DataItemName2="DataType2:DataValue2"
```

1. `RegistryEditorVersion` 宣告登陆编辑程序版本，通常 Windows 10 都是 5.0，所以第一行写 `Windows Registry Editor Version 5.00`

   如果没有声明，则会报错 `无法导入，指定文件不是注册脚本。你的注册表编辑器只能导入2进位注册文件`。

2. `Blank line` 空行，使用空行代表切换目录

3. `[RegistryPath]` 声明下个要操作的登陆路径，需要加上中括号表示。如果写的路径不存在，则会依照你指定的路径建立新的子键。

4. `"DataItemName"` 指定注册表项的名称，需要用双括号括住，如果不存在，则新建一项。

5. `DataType:DataValue` 指定注册表项值的类型和值。中间需要用冒号间隔

   - 字符串："Foo"="bar"
   - 二进制："Foo"=hex:
   - DWORD(32)："Foo"=dword:000000000
   - DWORD(64): "Foo"=hex(b):00,00,00,00,00,00,00,00

### 其他

如果要删除子键，直接在 DataItemName 的中括号内开头补上(-)，如 `[-HKEY_CURRENT_USER\Control Panel\Desktop\Some]`

注册表脚本注释标识符为`;`

一些注册表脚本：

- [为微软拼音添加小鹤双拼](https://github.com/chesterchenn/bak/blob/master/xiaohe.reg)

## 环境变量

对于需要频繁的切换环境变量值，我们可以创建文件 \*.bat

- 设置环境变量 `setx <ENV> <value>`
- 删除环境变量 `wmic ENVIRONMENT where "name='<ENV>'" delete`
- 查询环境变量 `set <ENV>`，使用 `pause` 暂停执行完毕不退出

`<ENV>` 需要设置的环境变量，`<value>` 环境变量的值
