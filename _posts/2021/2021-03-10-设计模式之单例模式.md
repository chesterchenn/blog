---
tags: algorithm
title: 设计模式之单例模式
---
单例模式（Singleton Design Pattern），一个类只允许创建一个对象（或者实例），这个类就是一个单例类，这种设计模式被叫做单例设计模式。

## 为什么要用单例？

#### 1. 处理资源访问冲突
当我们定义一个类的时候，若在不同的对象都创建该类，那么可能存在相互覆盖的问题。通过设计成一个单例类，在程序中只允许创建一个对象，所有的线程共享使用该对象，就可以避免会互相覆盖的问题。

#### 2. 表示全局唯一类
配置信息类等在系统只应保存一份的东西，比较适合设计成单例类。

## 如何实现一个单例？
- 构造函数需要是 private 访问权限，这样子才能避免外部通过 new 创建实例；
- 考虑对象创建时的线程安全问题；
- 考虑是否支持延迟加载；
- 考虑 getInstance() 性能是否够高（是否加锁）;

#### 1. 饿汉式
在类加载的时候，instance 静态实例就已经创建并初始化好了，所以，instance 实例的创建过程是线程安全的。不过不支持延迟加载。

#### 2. 懒汉式
懒汉式相对懒汉式优势是支持延迟加载。这种实现方式会导致频繁加锁、释放锁，以及并发度低等问题，频繁的调用会产生性能瓶颈。

#### 3. 双重检测
双重检测实现方式既支持延迟加载，又支持高并发的单例实现方式。只要 instance 被创建之后，再调用 getInstance() 函数都不会进入到加锁逻辑中。

#### 4. 静态内部类
利用 Java 的静态内部类来实现单例。这种实现方式，既支持延迟加载，也支持并高发，实现起来也比双重检测简单。

#### 5. 枚举
最简单的实现方式，基于枚举类型的单例实现。这种实现方式通过 Java 枚举类型本身的特性，保证了创建实例线程的线程安全行和实例的唯一性。

## 参考链接
- [极客时间：设计模式之美](https://time.geekbang.org/column/article/194035)