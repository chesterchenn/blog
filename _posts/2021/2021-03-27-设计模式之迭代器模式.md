---
layout: post
tags: 2021 algorithm
title: 设计模式之迭代器模式
---

迭代器模式（Iterator Design Pattern），也叫作游标模式（Cursor Design Pattern）。迭代器模式提供一种方法顺序访问一个聚合对象中的各个元素，而又不暴露其内部的表示。

迭代器是用来遍历容器的，所以，一个完整的迭代器模式一般会涉及容器和容器迭代器两部分内容。为了达到基于接口而非实现编程的目的，容器又包含容器接口、容器实现类，迭代器又包含迭代器接口、迭代器实现类。

## UML

![Iterator Design Pattern]({{ "images/DP_iterator_uml.svg" | relative_url }})

来源：《Head First 设计模式》

## 迭代器的优势

一般来讲，遍历集合数据有三种方法：for 循环、foreach 循环、iterator 迭代器。后两种本质上属于一种，都可以看作迭代器遍历。相对于 for 循环遍历，利用迭代器来遍历有下面三个优势：

- 迭代器模式封装集合内部的复杂数据结构，开发者不需要了解如何遍历，直接使用容器提供的迭代器即可；
- 迭代器模式将集合对象的遍历操作从集合类中拆分出来，放到迭代器类中，让两者的职责更加单一；
- 迭代器模式让添加新的遍历算法更加容易，更符合开闭原则。除此之外，因为迭代器都实现自相同的接口，在开发中，基于接口而非实现编程，替换迭代器也变得更加容易。

## 遍历过程增删元素

在通过迭代器来遍历集合元素的同时，增加或者删除集合中的元素，有可能会导致某个元素被重复遍历或遍历不到。不过，并不是所有情况下都会遍历出错，有的时候也可以正常遍历，所以，这种行为称为结果**不可预期行为**或者**未决行为**，也就是说，运行结果到底是对还是错，要视情况而定。

有两种比较干脆利索的解决方案：一种是遍历的时候不允许增删元素，另一种是增删元素之后让遍历报错。

## 参考链接

- [极客时间：设计模式之美](https://time.geekbang.org/column/article/219290)
- 《Head First 设计模式》
