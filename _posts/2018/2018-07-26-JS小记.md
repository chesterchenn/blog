---
layout: post
title: JS小记
tags: 2018 javascript
---

一些记录 JavaScript 的东西。

<!-- vim-markdown-toc GFM -->

- [取整](#取整)
- [slice 和 splice 的区别](#slice-和-splice-的区别)
- [可选链操作符](#可选链操作符)
- [空值合并操作符](#空值合并操作符)
- [计算属性名](#计算属性名)
- [HTML Symbol](#html-symbol)
- [for...in 与 for...of](#forin-与-forof)
- [千分位分隔符](#千分位分隔符)
- [解构赋值交换变量](#解构赋值交换变量)

<!-- vim-markdown-toc -->

## 取整

因为 JavaScript 里面都是浮点数，所以有时候运算操作需要取整操作

- 四舍五入 `Math.round()`
- 向上取整 `Math.ceil()`
- 向下取整 `Math.floor()`
- 向下取整 `~~` (参见常用位运算)
- 向下取整 `parseInt()` (可以用来取整，但定义是解析字符串，返回整数 [详见](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/parseInt))

## slice 和 splice 的区别

- slice 返回给定数组的浅拷贝数组，`arr.slice([begin[, end]])`
- splice 通过删除或者替换现有的元素，也可以在指定位置新增元素更改数组的元素。
  `let deletedItems = array.splice(start[, deleteCount[, item1[, ...]]])`
- slice 从数组中浅拷贝，不会更改原数组，返回浅拷贝的新数组。
- splice 在原数组修改，返回被删除的项。

两个主要区别:

- push(..) 原数组上操作，concat(..) 返回操作后的新数组
- 参数为数组的时候，push(..) 直接添加，concat(..) 会进行提取值再添加

## 可选链操作符

可选链操作符 ?. 允许读取位于连接对象链深处的属性的值，而不必验证链中的每个引用是否有效。?. 操作符的功能类似于 . 链式操作符，不同在于，在引用 null 或 undefined 的情况下不会引起错误，该表达式短路返回 undefined

```js
const obj = {};
console.log(obj && obj.a && obj.a.b && obj.a.b.c);
console.log(obj?.a?.b?.c); // 不会报错，原因是?.遇到是空值的时候便会返回 undefined
```

## 空值合并操作符

空值合并操作符 ?? 是一个逻辑操作符，当左侧的操作数为 null 或者 undefined 时，返回右侧的操作数，否则返回左侧的操作数。

```js
leftExpr ?? rightExpr;
```

空值合并操作符一般用来为常量提供默认值，保证常量不会为 null 或者 nudefined。

以前经常使用逻辑或操作符 `||` 进行操作。但是 `||` 左侧的操作数会被转换成布尔值进行求值，常见的假值（0, ''）会遇到意料之外的行为。

```js
false || 'foo'; // 'foo'
0 || 'foo'; // 'foo'
'' || 'foo'; // 'foo'

false ?? 'foo'; // false
0 ?? 'foo'; // 0
'' ?? 'foo'; // ''
```

## 计算属性名

在对象里，`[expression]: "computed property"` 属性名，指定一个表达式并用这个表达式的结果作为属性的名称。

## HTML Symbol

[HTML Symbol](https://www.htmlsymbol.com/)

## for...in 与 for...of

for...in 迭代对象的**可枚举字符串属性**，包括原型链上可枚举的属性。由于 Array 使用内置构造对象都是继承于 Object.prototype，所以也可以被遍历。

```js
for (variable in object) statement;
```

for...of 语句**迭代可迭代对象的值**。`Array`, `String`, `TypedArray`, `Map`, `Set`, `NodeList`, `arguments` 均可迭代，而对象 `object` 是不可迭代的，迭代 `object` 会报错。

```js
for (variable of iterable) statement;
```

- [for...in](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...in)
- [for...of](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/for...of)

## 千分位分隔符

```js
function _comma(number) {
  return number.toString().replace(/(\d)(?=(?:\d{3})+$)/g, '$1,');
}
```

[题解 \| 实现数字按每隔 3 位用,区隔开](https://blog.nowcoder.net/n/633bded80a164c5e946dfcce9df20327?f=comment)

## 解构赋值交换变量

可以利用结构赋值来快速交换变量值

```js
let [a, b] = ['Hello', 'World'];
[b, a] = [a, b];
console.log(a, b); // World Hello
```
